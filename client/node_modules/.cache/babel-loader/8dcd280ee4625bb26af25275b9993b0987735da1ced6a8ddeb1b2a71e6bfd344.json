{"ast":null,"code":"var _jsxFileName = \"/Users/abishan/Desktop/ReactProjects/Insightify/client/src/components/TopItems.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport TimeRangeSelector from './TimeRangeSelector.js';\nimport { getEndpointResult } from '../apiCalls.js';\nimport RenderTracks from '../TracksPage/RenderTracks.js';\nimport RenderArtists from '../ArtistsPage/RenderArtists.js';\nimport LoadingIcon from './LoadingIcon.js';\nimport spotifyIcon from \"../Spotify_Primary_Logo_RGB_White.png\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function TopItems({\n  type,\n  token,\n  storedTopItems,\n  updateTopItemsFunc\n}) {\n  _s();\n  const [items, setItems] = useState(storedTopItems); //{short_term: {items: [], next: endpoint}...}\n  const [error, setError] = useState(false);\n  const [currentTab, setCurrentTab] = useState(\"short_term\");\n  const firstUpdate = useRef(true); //check if component has initially rendered\n  const maxTopItems = 250; //number of top items that can be viewed\n  const onTabSwitch = tabName => setCurrentTab(tabName);\n  useEffect(() => {\n    //component Load\n    if (items[currentTab].items.length === 0) {\n      //uf no previous data is passed from parent \n      onGetTopItems();\n      return;\n    }\n    setItems(storedTopItems); //if data is passed update items\n    // eslint-disable-next-line\n  }, []);\n  useEffect(() => {\n    //runs every time a tab is changed, if tab is empty load data\n    if (firstUpdate.current) {\n      //dont run this effect on inital render\n      firstUpdate.current = false;\n      return;\n    }\n    if (items[currentTab].items.length === 0) {\n      onGetTopItems();\n    }\n    // eslint-disable-next-line\n  }, [currentTab]);\n  function onGetTopItems() {\n    //calls next endpoint for next set of 50 items under current timeRange\n    const promise = getEndpointResult(token, items[currentTab].next, `fetching more ${type} - ${currentTab}`);\n    promise.then(moreItemsResult => {\n      if (moreItemsResult === false) {\n        setError(true);\n        return;\n      }\n      let updatedItems = {\n        ...items\n      }; //create copy of items\n      updatedItems[currentTab].items = updatedItems[currentTab].items.concat(moreItemsResult.items); //add new items to current \n      updatedItems[currentTab].next = moreItemsResult.next; //set new next endpoint - if no more items .next returns null\n      setItems(updatedItems);\n      updateTopItemsFunc(updatedItems); //pass updatedItems to parent\n    }).catch(() => setError(true));\n  }\n  function moreItemsAvailableBtn() {\n    if (items[currentTab].next === null || items[currentTab].items.length >= maxTopItems) {\n      //if there are no more tracks dont display button \n      return;\n    }\n    return /*#__PURE__*/_jsxDEV(\"button\", {\n      className: \"more-btn\",\n      onClick: () => onGetTopItems(),\n      children: \"View More\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 13\n    }, this);\n  }\n  if (error) {\n    throw new Error(`Failed to fetch ${type} - ${currentTab}`);\n  }\n  if (items[currentTab].items.length === 0) {\n    //if api is still loading topItems\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: 'grid'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"page-title\",\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          children: [\"Your Top \", type.charAt(0).toUpperCase() + type.slice(1)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 66,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n          src: spotifyIcon,\n          alt: \"SpotifyIcon\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 67,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 65,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(TimeRangeSelector, {\n        tabSwitchHandler: () => {}\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(LoadingIcon, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 7\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      display: 'grid'\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"page-title\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        children: [\"Your Top \", type.charAt(0).toUpperCase() + type.slice(1)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n        src: spotifyIcon,\n        alt: \"SpotifyIcon\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(TimeRangeSelector, {\n      tabSwitchHandler: onTabSwitch\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 7\n    }, this), type === 'tracks' ? /*#__PURE__*/_jsxDEV(RenderTracks, {\n      tracks: items[currentTab].items\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(RenderArtists, {\n      artists: items[currentTab].items\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 9\n    }, this), moreItemsAvailableBtn(), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        height: 20\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 75,\n    columnNumber: 5\n  }, this);\n}\n_s(TopItems, \"l8wW7Z2y4Dxjo+cJmdIfrkC0B2I=\");\n_c = TopItems;\nvar _c;\n$RefreshReg$(_c, \"TopItems\");","map":{"version":3,"names":["React","useState","useEffect","useRef","TimeRangeSelector","getEndpointResult","RenderTracks","RenderArtists","LoadingIcon","spotifyIcon","jsxDEV","_jsxDEV","TopItems","type","token","storedTopItems","updateTopItemsFunc","_s","items","setItems","error","setError","currentTab","setCurrentTab","firstUpdate","maxTopItems","onTabSwitch","tabName","length","onGetTopItems","current","promise","next","then","moreItemsResult","updatedItems","concat","catch","moreItemsAvailableBtn","className","onClick","children","fileName","_jsxFileName","lineNumber","columnNumber","Error","style","display","charAt","toUpperCase","slice","src","alt","tabSwitchHandler","tracks","artists","height","_c","$RefreshReg$"],"sources":["/Users/abishan/Desktop/ReactProjects/Insightify/client/src/components/TopItems.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport TimeRangeSelector from './TimeRangeSelector.js';\nimport { getEndpointResult } from '../apiCalls.js';\nimport RenderTracks from '../TracksPage/RenderTracks.js';\nimport RenderArtists from '../ArtistsPage/RenderArtists.js';\nimport LoadingIcon from './LoadingIcon.js';\nimport spotifyIcon from \"../Spotify_Primary_Logo_RGB_White.png\"\n\nexport default function TopItems({ type, token, storedTopItems, updateTopItemsFunc }) {\n  const [items, setItems] = useState(storedTopItems); //{short_term: {items: [], next: endpoint}...}\n  const [error, setError] = useState(false);\n  const [currentTab, setCurrentTab] = useState(\"short_term\");\n  const firstUpdate = useRef(true);//check if component has initially rendered\n  const maxTopItems = 250//number of top items that can be viewed\n  const onTabSwitch = (tabName) => setCurrentTab(tabName);\n  \n  useEffect(() => {//component Load\n    if (items[currentTab].items.length===0){//uf no previous data is passed from parent \n      onGetTopItems()\n      return\n    }\n    setItems(storedTopItems)//if data is passed update items\n     // eslint-disable-next-line\n  }, []);\n  \n  useEffect(() => {//runs every time a tab is changed, if tab is empty load data\n    if (firstUpdate.current) {//dont run this effect on inital render\n      firstUpdate.current = false;\n      return;\n    }\n    \n    if (items[currentTab].items.length===0){\n      onGetTopItems()\n    }\n     // eslint-disable-next-line\n  }, [currentTab]);\n\n \n  function onGetTopItems() { //calls next endpoint for next set of 50 items under current timeRange\n    const promise = getEndpointResult(token, items[currentTab].next, `fetching more ${type} - ${currentTab}`);\n    promise.then((moreItemsResult) => {\n      if (moreItemsResult === false){\n        setError(true);\n        return;\n      }\n      let updatedItems = { ...items };//create copy of items\n      updatedItems[currentTab].items = updatedItems[currentTab].items.concat(moreItemsResult.items);//add new items to current \n      updatedItems[currentTab].next = moreItemsResult.next;//set new next endpoint - if no more items .next returns null\n      setItems(updatedItems);\n      updateTopItemsFunc(updatedItems);//pass updatedItems to parent\n    }).catch(() => setError(true));\n  }\n\n  function moreItemsAvailableBtn() {\n    if (items[currentTab].next === null || items[currentTab].items.length >= maxTopItems) {//if there are no more tracks dont display button \n      return\n    }\n    return (<button className=\"more-btn\" onClick={() => onGetTopItems()}>View More</button>);\n  }\n\n  if (error) { throw new Error(`Failed to fetch ${type} - ${currentTab}`); }\n  if (items[currentTab].items.length === 0) {//if api is still loading topItems\n    return (\n      <div style={{ display: 'grid' }}>\n        <div className=\"page-title\">\n          <h1>Your Top {type.charAt(0).toUpperCase() + type.slice(1)}</h1>\n          <img src={spotifyIcon} alt=\"SpotifyIcon\"></img>\n        </div>\n        <TimeRangeSelector tabSwitchHandler={()=>{}} />\n        <LoadingIcon />\n      </div>\n    );\n  }\n  return (\n    <div style={{ display: 'grid' }}>\n      <div className=\"page-title\">\n        <h1>Your Top {type.charAt(0).toUpperCase() + type.slice(1)}</h1>\n        <img src={spotifyIcon} alt=\"SpotifyIcon\"></img>\n      </div>\n    \n      <TimeRangeSelector tabSwitchHandler={onTabSwitch} />\n      {type === 'tracks' ? (\n        <RenderTracks tracks={items[currentTab].items} />\n      ) : (\n        <RenderArtists artists={items[currentTab].items} />\n      )}\n      {moreItemsAvailableBtn()}\n      <div style={{ height: 20 }}></div>\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}